<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>–≠–ª–µ–º–µ–Ω—Ç—ã —Ç–µ–∫—Å—Ç–∞ ‚Äî –Ω–∞–π–¥–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: linear-gradient(145deg, #fbe9f0 0%, #e0f2f1 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Georgia', 'Times New Roman', 'Palatino', 'Dancing Script', cursive, serif;
            padding: 16px;
            margin: 0;
        }

        .game-container {
            max-width: 1200px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(4px);
            border-radius: 48px 48px 32px 32px;
            box-shadow: 0 25px 40px -10px rgba(169, 145, 156, 0.5);
            padding: 30px 25px;
            border: 2px solid #fff9;
            transition: all 0.3s ease;
        }

        h1 {
            font-size: 3.2rem;
            font-weight: 400;
            font-family: 'Dancing Script', 'Georgia', cursive;
            color: #5e5b70;
            text-align: center;
            margin-bottom: 0px;
            letter-spacing: 2px;
            text-shadow: 3px 3px 0 #ffd9df;
            line-height: 1.2;
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 400;
            font-family: 'Caveat', 'Comic Sans MS', cursive;
            color: #8b7b8d;
            text-align: center;
            margin-top: -5px;
            margin-bottom: 25px;
            border-bottom: 2px dashed #dbb6c6;
            padding-bottom: 10px;
        }

        .info-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #ffe6ebcc;
            padding: 15px 25px;
            border-radius: 60px;
            margin-bottom: 30px;
            font-size: 1.7rem;
            color: #5e4b5c;
            border: 2px solid #f9ced9;
            flex-wrap: wrap;
            gap: 10px;
        }

        .timer {
            background: #b5d9d1;
            padding: 10px 22px;
            border-radius: 40px;
            box-shadow: inset 0 -3px 0 #8bb3aa;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 2rem;
            color: #2d4e47;
            letter-spacing: 5px;
        }

        .score {
            background: #fad5e2;
            padding: 10px 30px;
            border-radius: 40px;
            box-shadow: inset 0 -3px 0 #cf9faf;
            font-size: 2rem;
        }

        .game-board {
            display: flex;
            flex-direction: row;
            gap: 20px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .column {
            flex: 1 1 300px;
            background: #fdf1f5d9;
            border-radius: 50px 50px 30px 30px;
            padding: 25px 15px;
            box-shadow: 0 10px 0 #d8b7c2;
            border: 2px solid #ffeef2;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .column h3 {
            font-size: 2.2rem;
            color: #6d5468;
            text-align: center;
            margin-bottom: 5px;
            font-weight: 400;
            border-bottom: 1px solid #cdb5c1;
            padding-bottom: 10px;
        }

        .card {
            background: #faf0f2;
            border: 3px solid #fff0f3;
            border-radius: 40px 20px 40px 20px;
            padding: 22px 18px;
            font-size: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 8px 0 #d2b1bc, 0 2px 15px rgba(187, 147, 156, 0.3);
            color: #3f3a47;
            font-weight: 500;
            word-break: break-word;
        }

        .card.term {
            background: #fee3c0;
            border-color: #ffcfaa;
        }

        .card.definition {
            background: #c7e3e0;
            border-color: #afd1cf;
        }

        .card.selected {
            transform: scale(1.02);
            border: 4px solid #b9808a;
            box-shadow: 0 0 0 3px #ffb6c1, 0 8px 0 #b9808a;
        }

        .card.matched {
            opacity: 0.7;
            background: #c8e6c9 !important;
            border-color: #81c784 !important;
            box-shadow: 0 4px 0 #519657 !important;
            cursor: default;
            pointer-events: none;
            text-decoration: line-through 2px #2e7d32;
            filter: grayscale(0.2);
        }

        .card.term.matched {
            background: #c8e6c9 !important;
        }
        .card.definition.matched {
            background: #c8e6c9 !important;
        }

        .footer-hint {
            text-align: center;
            font-size: 1.5rem;
            color: #766573;
            background: #fbe4e9c0;
            padding: 15px;
            border-radius: 50px;
            margin: 25px 0 0;
            border: 1px solid #edd0d6;
        }

        /* –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—à–∏–±–∫–∏ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #a1a1a180;
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal {
            background: #fff5f9;
            border: 5px solid #fbc1cb;
            border-radius: 90px 30px 90px 30px;
            padding: 40px 35px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 30px 0 #b3a0ac;
            font-family: 'Dancing Script', cursive;
        }

        .modal p {
            font-size: 3rem;
            color: #8a535f;
            margin-bottom: 35px;
            line-height: 1.3;
        }

        .modal-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        .btn {
            border: none;
            background: #ffe09c;
            padding: 16px 28px;
            border-radius: 60px;
            font-size: 2rem;
            font-family: 'Caveat', cursive;
            font-weight: bold;
            color: #4d3b3f;
            box-shadow: 0 7px 0 #c9a67b;
            transition: 0.1s ease;
            cursor: pointer;
            border: 2px solid #fcf2d7;
            flex: 0 1 auto;
        }

        .btn:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #c9a67b;
        }

        .btn.restart {
            background: #d9c2e8;
            box-shadow: 0 7px 0 #a28bb0;
        }

        /* —ç–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .result-screen {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #ffe8eeb0;
            backdrop-filter: blur(6px);
            align-items: center;
            justify-content: center;
            z-index: 1100;
        }

        .result-card {
            background: #fff1f4;
            border-radius: 120px 30px 120px 30px;
            border: 6px solid #ffe0b5;
            padding: 50px 40px;
            max-width: 650px;
            width: 90%;
            text-align: center;
            box-shadow: 0 40px 0 #bc9faa;
        }

        .result-card h3 {
            font-size: 4rem;
            color: #755572;
            margin-bottom: 25px;
            font-weight: 400;
        }

        .result-text {
            font-size: 3rem;
            background: #fee0b7;
            padding: 30px 20px;
            border-radius: 50px;
            margin: 25px 0;
            color: #513d49;
        }

        .btn-result {
            background: #b7d5cd;
            font-size: 2.8rem;
            padding: 25px 55px;
            box-shadow: 0 10px 0 #7d9e94;
            border: 3px solid white;
        }

        /* –∑–≤–µ–∑–¥–æ—á–∫–∏ –∞–Ω–∏–º–∞—Ü–∏—è */
        .stars-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1200;
            overflow: hidden;
        }

        .star {
            position: absolute;
            font-size: 3rem;
            color: #f7e05e;
            filter: drop-shadow(0 0 5px gold);
            animation: fly 2s ease-out forwards;
        }

        @keyframes fly {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
            100% { transform: translate(calc(100vw - 200px), calc(-100vh + 150px)) rotate(360deg); opacity: 0; }
        }

        /* –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 750px) {
            .game-board { flex-direction: column; }
            h1 { font-size: 2.8rem; }
            .info-panel { font-size: 1.2rem; }
            .timer { font-size: 1.6rem; padding: 8px 15px; }
            .score { font-size: 1.6rem; padding: 8px 20px; }
            .card { font-size: 1.2rem; padding: 15px 10px; }
            .modal p { font-size: 2.2rem; }
            .btn { font-size: 1.5rem; padding: 12px 20px; }
        }
        @media (max-width: 480px) {
            h1 { font-size: 2.3rem; }
            h2 { font-size: 1.4rem; }
        }

        /* –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã */
        .game-container.game-completed .card:not(.matched) {
            pointer-events: none;
            opacity: 0.6;
        }

        .emoji-icon {
            font-size: 1.7rem;
            margin-right: 6px;
        }
    </style>
</head>
<body>
    <div class="game-container" id="gameContainer">
        <h1>üìú –≠–ª–µ–º–µ–Ω—Ç—ã —Ç–µ–∫—Å—Ç–∞</h1>
        <h2>‚úèÔ∏è –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä</h2>

        <div class="info-panel">
            <div class="timer" id="timerDisplay">05:00</div>
            <div class="score" id="scoreDisplay">0 / 5</div>
        </div>

        <div class="game-board" id="gameBoard">
            <!-- –∫–æ–ª–æ–Ω–∫–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∏–∑ JS -->
        </div>

        <div class="footer-hint">
            <span class="emoji-icon">üßê</span> –ù–∞–∂–º–∏ –Ω–∞ —Ç–µ—Ä–º–∏–Ω —Å–ª–µ–≤–∞, –ø–æ—Ç–æ–º –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–∞
        </div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ –æ—à–∏–±–∫–∏ -->
    <div class="modal-overlay" id="errorModal">
        <div class="modal">
            <p>‚ùå –û—à–∏–±–æ—á–∫–∞! <br> –≠—Ç–æ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç</p>
            <div class="modal-buttons">
                <button class="btn" id="chooseAnotherBtn">üîÅ –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç</button>
                <button class="btn restart" id="restartFromErrorBtn">üîÑ –ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞</button>
            </div>
        </div>
    </div>

    <!-- —ç–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
    <div class="result-screen" id="resultScreen">
        <div class="result-card">
            <h3>üéâ –ò—Ç–æ–≥ –∏–≥—Ä—ã</h3>
            <div class="result-text" id="resultMessage">–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ X –∏–∑ 5 –∑–∞–¥–∞–Ω–∏–π</div>
            <button class="btn btn-result" id="restartFromResultBtn">‚ú® –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ ‚ú®</button>
        </div>
    </div>

    <!-- –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–≤–µ–∑–¥–æ—á–µ–∫ -->
    <div class="stars-container" id="starsContainer" style="display: none;"></div>

    <script>
        (function() {
            // ---------- –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã ----------
            const items = [
                { term: "–°–∏–º–≤–æ–ª", definition: "–°–∞–º—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ (–±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –∑–Ω–∞–∫–∏ +, >, !, ‚Ññ)" },
                { term: "–°–ª–æ–≤–æ", definition: "–°–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–∏–º–≤–æ–ª–æ–≤, –æ—Ç–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–æ–±–µ–ª–∞–º–∏" },
                { term: "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ", definition: "–°–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–æ–≤ –∏ —Å–∏–º–≤–æ–ª–æ–≤. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –±–æ–ª—å—à–æ–π –±—É–∫–≤—ã." },
                { term: "–°—Ç—Ä–æ–∫–∞", definition: "–°–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–æ–≤ –∏ —Å–∏–º–≤–æ–ª–æ–≤, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –º–µ–∂–¥—É –ø—Ä–∞–≤–æ–π –∏ –ª–µ–≤–æ–π –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —Ç–µ–∫—Å—Ç–∞." },
                { term: "–ê–±–∑–∞—Ü", definition: "–§—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏" }
            ];

            // —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            let definitionsList = [];            // –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ { id: indexTerm, text: definition }
            let matchedTerm = [false, false, false, false, false];
            let matchedDef = [false, false, false, false, false];  // –∏–Ω–¥–µ–∫—Å—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç definitionsList (–ø–æ—Ä—è–¥–æ–∫ –Ω–∞ —ç–∫—Ä–∞–Ω–µ)
            let correctCount = 0;
            let selectedTermId = null;           // –∏–Ω–¥–µ–∫—Å —Ç–µ—Ä–º–∏–Ω–∞ (0-4)
            let timeLeft = 300;                   // 5 –º–∏–Ω—É—Ç = 300 —Å–µ–∫—É–Ω–¥
            let timerInterval = null;
            let gameActive = true;
            let gameCompleted = false;             // –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º resultscreen)

            // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
            const gameBoard = document.getElementById('gameBoard');
            const timerDisplay = document.getElementById('timerDisplay');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const errorModal = document.getElementById('errorModal');
            const chooseAnotherBtn = document.getElementById('chooseAnotherBtn');
            const restartFromErrorBtn = document.getElementById('restartFromErrorBtn');
            const resultScreen = document.getElementById('resultScreen');
            const resultMessage = document.getElementById('resultMessage');
            const restartFromResultBtn = document.getElementById('restartFromResultBtn');
            const gameContainer = document.getElementById('gameContainer');
            const starsContainer = document.getElementById('starsContainer');

            // ---------- –∑–≤—É–∫–∏ —á–µ—Ä–µ–∑ Web Audio API (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) ----------
            let audioCtx = null;

            function initAudioContext() {
                if (audioCtx) return;
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }

            function playSound(type) {
                initAudioContext();
                if (!audioCtx) return;
                // –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –ø–æ–ø—ã—Ç–∞–µ–º—Å—è –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume().then(() => playSoundNow(type)).catch(() => {});
                } else if (audioCtx.state === 'running') {
                    playSoundNow(type);
                }
            }

            function playSoundNow(type) {
                if (!audioCtx) return;
                const now = audioCtx.currentTime;
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);

                let freq = 600;
                let duration = 0.15;
                if (type === 'correct') {
                    freq = 880;
                    duration = 0.2;
                } else if (type === 'incorrect') {
                    freq = 240;
                    duration = 0.25;
                } else if (type === 'gameover') {
                    freq = 420;
                    duration = 0.5;
                }

                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.2, now);
                gain.gain.exponentialRampToValueAtTime(0.0001, now + duration);
                osc.start(now);
                osc.stop(now + duration);
                osc.onended = () => osc.disconnect();
            }

            // ---------- —Ç–∞–π–º–µ—Ä ----------
            function startTimer() {
                if (timerInterval) clearInterval(timerInterval);
                timerInterval = setInterval(() => {
                    if (!gameActive || gameCompleted) return;
                    timeLeft -= 1;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        timeLeft = 0;
                        updateTimerDisplay();
                        gameFinished('timeout');
                    }
                }, 1000);
            }

            function stopTimer() {
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
            }

            function updateTimerDisplay() {
                const mins = Math.floor(timeLeft / 60);
                const secs = timeLeft % 60;
                timerDisplay.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }

            // ---------- –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π ----------
            function shuffleArray(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            function buildDefinitionsList() {
                const defs = items.map((item, idx) => ({ id: idx, text: item.definition }));
                return shuffleArray(defs);
            }

            // ---------- –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–æ–ª–æ–Ω–æ–∫ ----------
            function renderBoard() {
                const leftCol = document.createElement('div');
                leftCol.className = 'column';
                leftCol.innerHTML = '<h3>üìå –ü–æ–Ω—è—Ç–∏—è</h3>';
                const rightCol = document.createElement('div');
                rightCol.className = 'column';
                rightCol.innerHTML = '<h3>üìù –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</h3>';

                // –ª–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (—Ç–µ—Ä–º–∏–Ω—ã)
                items.forEach((item, idx) => {
                    const card = document.createElement('div');
                    card.className = `card term ${matchedTerm[idx] ? 'matched' : ''}`;
                    if (selectedTermId === idx && !matchedTerm[idx]) card.classList.add('selected');
                    card.dataset.termId = idx;
                    card.textContent = item.term;
                    if (!matchedTerm[idx]) {
                        card.addEventListener('click', () => onTermClick(idx));
                    }
                    leftCol.appendChild(card);
                });

                // –ø—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º definitionsList
                definitionsList.forEach((def, idx) => {
                    const card = document.createElement('div');
                    card.className = `card definition ${matchedDef[idx] ? 'matched' : ''}`;
                    card.dataset.defIndex = idx; // –∏–Ω–¥–µ–∫—Å –≤ definitionsList
                    card.textContent = def.text;
                    if (!matchedDef[idx]) {
                        card.addEventListener('click', () => onDefClick(idx));
                    }
                    rightCol.appendChild(card);
                });

                gameBoard.innerHTML = '';
                gameBoard.appendChild(leftCol);
                gameBoard.appendChild(rightCol);
            }

            // ---------- –∫–ª–∏–∫ –ø–æ —Ç–µ—Ä–º–∏–Ω—É ----------
            function onTermClick(termId) {
                if (!gameActive || gameCompleted || matchedTerm[termId]) return;
                // —É–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
                selectedTermId = termId;
                // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å (–ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å)
                renderBoard();
            }

            // ---------- –∫–ª–∏–∫ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é ----------
            function onDefClick(defIndex) {
                if (!gameActive || gameCompleted || matchedDef[defIndex]) return;
                if (selectedTermId === null) {
                    // –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É –∏–ª–∏ –∏–≥–Ω–æ—Ä
                    return;
                }

                const defItem = definitionsList[defIndex];
                if (defItem.id === selectedTermId) {
                    // –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç!
                    playSound('correct');
                    // –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ
                    matchedTerm[selectedTermId] = true;
                    matchedDef[defIndex] = true;
                    correctCount++;
                    updateScore();
                    selectedTermId = null;
                    renderBoard();
                    checkGameComplete();
                } else {
                    // –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
                    playSound('incorrect');
                    // –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É (–Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º selectedTermId)
                    showErrorModal();
                }
            }

            // ---------- –º–æ–¥–∞–ª–∫–∞ –æ—à–∏–±–∫–∏ ----------
            function showErrorModal() {
                errorModal.style.display = 'flex';
                gameActive = false;  // –±–ª–æ–∫–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–∫–∞ –º–æ–¥–∞–ª–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞
            }

            function hideErrorModal() {
                errorModal.style.display = 'none';
                gameActive = true;
                // –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
                renderBoard();
            }

            // ---------- –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞ ----------
            function updateScore() {
                scoreDisplay.textContent = `${correctCount} / 5`;
            }

            // ---------- –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ----------
            function checkGameComplete() {
                if (correctCount === 5) {
                    gameFinished('win');
                }
            }

            // ---------- –æ–∫–æ–Ω—á–∞–Ω–∏–µ –∏–≥—Ä—ã (–ø–æ–±–µ–¥–∞ –∏–ª–∏ –≤—Ä–µ–º—è) ----------
            function gameFinished(reason) {
                if (gameCompleted) return;
                gameCompleted = true;
                gameActive = false;
                stopTimer();
                playSound('gameover');

                // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                resultMessage.textContent = `–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ ${correctCount} –∏–∑ 5 –∑–∞–¥–∞–Ω–∏–π`;
                resultScreen.style.display = 'flex';
                gameContainer.classList.add('game-completed');

                // –∑–∞–ø—É—Å–∫–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏
                showStars();
            }

            // ---------- –∑–≤–µ–∑–¥–æ—á–∫–∏ ----------
            function showStars() {
                starsContainer.style.display = 'block';
                starsContainer.innerHTML = '';
                for (let i = 0; i < 35; i++) {
                    const star = document.createElement('div');
                    star.className = 'star';
                    star.textContent = ['‚òÖ', '‚ú®', '‚≠ê', 'üåü', 'üí´'][Math.floor(Math.random() * 5)];
                    star.style.left = Math.random() * 100 + '%';
                    star.style.top = Math.random() * 100 + '%';
                    star.style.fontSize = (Math.random() * 3 + 2) + 'rem';
                    star.style.animationDuration = (Math.random() * 2 + 1.5) + 's';
                    star.style.animationDelay = Math.random() * 0.5 + 's';
                    starsContainer.appendChild(star);
                }
                // —É–±–µ—Ä–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    starsContainer.style.display = 'none';
                }, 3000);
            }

            // ---------- –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ–π –∏–≥—Ä—ã ----------
            function restartGame() {
                // —Å–±—Ä–æ—Å –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
                stopTimer();
                definitionsList = buildDefinitionsList();
                matchedTerm = [false, false, false, false, false];
                matchedDef = [false, false, false, false, false];
                correctCount = 0;
                selectedTermId = null;
                timeLeft = 300;
                gameActive = true;
                gameCompleted = false;
                updateTimerDisplay();
                updateScore();
                gameContainer.classList.remove('game-completed');
                errorModal.style.display = 'none';
                resultScreen.style.display = 'none';
                starsContainer.style.display = 'none';
                renderBoard();
                startTimer();
            }

            // ---------- –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ ----------
            chooseAnotherBtn.addEventListener('click', () => {
                hideErrorModal();
                // –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞ –æ—Å—Ç–∞—ë—Ç—Å—è, –ø—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä—ã–ª–∏ –º–æ–¥–∞–ª–∫—É
                // –Ω–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å, –≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ —É–∂–µ –µ—Å—Ç—å
                renderBoard();
            });

            restartFromErrorBtn.addEventListener('click', () => {
                restartGame();
            });

            restartFromResultBtn.addEventListener('click', () => {
                restartGame();
            });

            // –∫–ª–∏–∫ –≤–Ω–µ –º–æ–¥–∞–ª–∫–∏ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –µ—ë, —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∏

            // ---------- –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ----------
            function initGame() {
                definitionsList = buildDefinitionsList();
                renderBoard();
                startTimer();
                gameActive = true;
                gameCompleted = false;
                gameContainer.classList.remove('game-completed');
                errorModal.style.display = 'none';
                resultScreen.style.display = 'none';
            }

            initGame();

            // –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–æ–≤ –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
            // –Ω–æ –∫–ª–∏–∫–∏ —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç –∞—É–¥–∏–æ–∫–æ–Ω—Ç–µ–∫—Å—Ç
        })();
    </script>
</body>
</html>